<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Blog | LMQL</title>
    <meta name="description" content="Language Model Query Language">
    <link rel="preload stylesheet" href="/assets/style.d660084a.css" as="style">
    
    <script type="module" src="/assets/app.7a112693.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.2ed14f66.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/framework.980cae92.js">
    <link rel="modulepreload" href="/assets/chunks/theme.908ddb20.js">
    <link rel="modulepreload" href="/assets/chunks/VersionSwitch.5d3190fc.js">
    <link rel="modulepreload" href="/assets/blog_index.md.78d1ea8e.lean.js">
    <script async src="/promptdown.js"></script>
    <script src="https://static.cloudflareinsights.com/beacon.min.js?token=f7d2a6b1a0624c51ae4dab9a4239b77d&amp;spa=false"></script>
    <script async src="https://buttons.github.io/buttons.js"></script>
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-9d8abc1e><!--[--><!--]--><!--[--><span tabindex="-1" data-v-c8291ffa></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-c8291ffa> Skip to content </a><!--]--><!----><header class="VPNav" data-v-9d8abc1e data-v-7ad780c2><div class="VPNavBar" data-v-7ad780c2 data-v-f1abbc6e><div class="container" data-v-f1abbc6e><div class="title" data-v-f1abbc6e><div class="VPNavBarTitle" data-v-f1abbc6e data-v-2973dbb4><a class="title" href="/" data-v-2973dbb4><!--[--><!--]--><!--[--><img class="VPImage logo" src="/lmql.svg" alt data-v-ab19afbb><!--]--><!--[-->LMQL<!--]--><!--[--><!--]--></a></div></div><div class="content" data-v-f1abbc6e><div class="curtain" data-v-f1abbc6e></div><div class="content-body" data-v-f1abbc6e><!--[--><!--]--><div class="VPNavBarSearch search" data-v-f1abbc6e><!--[--><!----><div id="docsearch"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg class="DocSearch-Search-Icon" width="20" height="20" viewBox="0 0 20 20" aria-label="search icon"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-f1abbc6e data-v-f732b5d0><span id="main-nav-aria-label" class="visually-hidden" data-v-f732b5d0>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/" tabindex="0" data-v-f732b5d0 data-v-cb318fec><!--[--><span data-v-cb318fec>Home</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink active" href="/blog/" tabindex="0" data-v-f732b5d0 data-v-cb318fec><!--[--><span data-v-cb318fec>Blog</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/research/index.html" tabindex="0" data-v-f732b5d0 data-v-cb318fec><!--[--><span data-v-cb318fec>Research</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/docs/" tabindex="0" data-v-f732b5d0 data-v-cb318fec><!--[--><span data-v-cb318fec>Docs</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/playground/" target="_blank" tabindex="0" data-v-f732b5d0 data-v-cb318fec><!--[--><span data-v-cb318fec>‚ñ∂ Playground</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-f1abbc6e data-v-283b26e9><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="toggle dark mode" aria-checked="false" data-v-283b26e9 data-v-3329432d data-v-1c29e291><span class="check" data-v-1c29e291><span class="icon" data-v-1c29e291><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-3329432d><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-3329432d><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-f1abbc6e data-v-ef6192dc data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/eth-sri/lmql" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-16cf740a><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><a class="VPSocialLink no-icon" href="https://discord.gg/5djae9gJVB" aria-label="discord" target="_blank" rel="noopener" data-v-e71e869c data-v-16cf740a><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Discord</title><path d="M20.317 4.3698a19.7913 19.7913 0 00-4.8851-1.5152.0741.0741 0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.68-.2762-5.4868 0-.1636-.3933-.4058-.8742-.6177-1.2495a.077.077 0 00-.0785-.037 19.7363 19.7363 0 00-4.8852 1.515.0699.0699 0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824 0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777 0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076 0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077 0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743 0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614 0a.0739.0739 0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077 0 01-.0066.1276 12.2986 12.2986 0 01-1.873.8914.0766.0766 0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076 0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077 0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061 0 00-.0312-.0286zM8.02 15.3312c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9555-2.4189 2.157-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.9555 2.4189-2.1569 2.4189zm7.9748 0c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9554-2.4189 2.1569-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.946 2.4189-2.1568 2.4189Z"/></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-f1abbc6e data-v-c8c2ae4b data-v-aa8de344><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-aa8de344><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-aa8de344><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-aa8de344><div class="VPMenu" data-v-aa8de344 data-v-e42ed9b3><!----><!--[--><!--[--><!----><div class="group" data-v-c8c2ae4b><div class="item appearance" data-v-c8c2ae4b><p class="label" data-v-c8c2ae4b>Appearance</p><div class="appearance-action" data-v-c8c2ae4b><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="toggle dark mode" aria-checked="false" data-v-c8c2ae4b data-v-3329432d data-v-1c29e291><span class="check" data-v-1c29e291><span class="icon" data-v-1c29e291><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-3329432d><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-3329432d><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><div class="group" data-v-c8c2ae4b><div class="item social-links" data-v-c8c2ae4b><div class="VPSocialLinks social-links-list" data-v-c8c2ae4b data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/eth-sri/lmql" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-16cf740a><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><a class="VPSocialLink no-icon" href="https://discord.gg/5djae9gJVB" aria-label="discord" target="_blank" rel="noopener" data-v-e71e869c data-v-16cf740a><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Discord</title><path d="M20.317 4.3698a19.7913 19.7913 0 00-4.8851-1.5152.0741.0741 0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.68-.2762-5.4868 0-.1636-.3933-.4058-.8742-.6177-1.2495a.077.077 0 00-.0785-.037 19.7363 19.7363 0 00-4.8852 1.515.0699.0699 0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824 0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777 0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076 0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077 0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743 0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614 0a.0739.0739 0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077 0 01-.0066.1276 12.2986 12.2986 0 01-1.873.8914.0766.0766 0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076 0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077 0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061 0 00-.0312-.0286zM8.02 15.3312c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9555-2.4189 2.157-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.9555 2.4189-2.1569 2.4189zm7.9748 0c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9554-2.4189 2.1569-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.946 2.4189-2.1568 2.4189Z"/></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-f1abbc6e data-v-6bee1efd><span class="container" data-v-6bee1efd><span class="top" data-v-6bee1efd></span><span class="middle" data-v-6bee1efd></span><span class="bottom" data-v-6bee1efd></span></span></button></div></div></div></div><!----></header><div class="VPLocalNav fixed reached-top" data-v-9d8abc1e data-v-9e669cc1><!----><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-9e669cc1 data-v-24251f6f><button data-v-24251f6f>Return to top</button><!----></div></div><!----><div class="VPContent" id="VPContent" data-v-9d8abc1e data-v-3cf691b6><div class="VPDoc" data-v-3cf691b6 data-v-a3c25e27><!--[--><!--]--><div class="container" data-v-a3c25e27><!----><div class="content" data-v-a3c25e27><div class="content-container" data-v-a3c25e27><!--[--><!--]--><!----><main class="main" data-v-a3c25e27><div style="position:relative;" class="vp-doc _blog_" data-v-a3c25e27><div data-v-61c06c99><!--[--><div class="posts" data-v-61c06c99><div class="post" data-v-61c06c99><a href="/blog/posts/release-0.7.html" data-v-61c06c99><h1 data-v-61c06c99>LMQL 0.7 brings Procedural Prompt Programming</h1></a><div class="body" data-v-61c06c99><h1 id="lmql-0-7-brings-procedural-prompt-programming" tabindex="-1">LMQL 0.7 brings Procedural Prompt Programming <a class="header-anchor" href="#lmql-0-7-brings-procedural-prompt-programming" aria-label="Permalink to &quot;LMQL 0.7 brings Procedural Prompt Programming&quot;">&ZeroWidthSpace;</a></h1>
<p><span class="date">October 10, 2023</span></p>
<p>Today, we are releasing LMQL 0.7. This series is the biggest update since the original release, including many community contributions. Next to several new main-line features like nested queries, the Generations API and the Chat API, it also includes several <em>experimental preview features</em>, allowing you to experiment with new incoming functionality before it is fully released.</p>
<p>LMQL 0.7 has also moved to <a href="https://semver.org" target="_blank" rel="noreferrer">semantic versioning</a> with the direct predecessor being 0.0.6.6. This means that the next feature release will be 0.8, and the next bugfix release will be 0.7.1.</p>
<h2 id="nested-queries-for-procedural-prompt-programming" tabindex="-1">Nested Queries for Procedural Prompt Programming <a class="header-anchor" href="#nested-queries-for-procedural-prompt-programming" aria-label="Permalink to &quot;Nested Queries for Procedural Prompt Programming&quot;">&ZeroWidthSpace;</a></h2>
<p>In 0.7, you can now use <a href="./../../docs/language/nestedqueries.html">Nested Queries</a> to call an LMQL query as a nested function in the context of another query. For this, LMQL implements procedural programming for prompting. To illustrate, consider the following example:</p>
<div class="language-lmql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">lmql</span><pre class="hljs"><code><span class="line"><span class="hljs-comment"># chain of thought prompting strategy</span>
<span class="hljs-meta">@lmql.query</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">chain_of_thought</span>():
    <span class="hljs-inline-lmql"><span class='inline-lmql-delim'>&#x27;&#x27;&#x27;lmql</span>
    <span class="hljs-string">&quot;A: Let&#x27;s think step by step.\n <span class="hljs-placeholder">[REASONING]</span>&quot;</span>
    <span class="hljs-string">&quot;Therefore the answer is<span class="hljs-placeholder">[ANSWER]</span>&quot;</span> <span class="hljs-keyword">where</span> STOPS_AT(ANSWER, <span class="hljs-string">&quot;.&quot;</span>)
    <span class="hljs-keyword">return</span> ANSWER.strip()
    <span class='inline-lmql-delim'>&#x27;&#x27;&#x27;</span></span>

<span class="hljs-comment"># top-level query</span>
<span class="hljs-string">&quot;Q: It is August 12th, 2020. What date was it \
    100 days ago? <span class="hljs-placeholder">[ANSWER: chain_of_thought]</span>&quot;</span>

ANSWER <span class="hljs-comment"># May 4th, 2020</span>
</span></code></pre>
</div><p>We first define a simple LMQL function <code>chain_of_thought</code> to do <em>chain-of-thought prompting</em>. In our top-level query, we can then call this function to decode an answer using the <code>[ANSWER: chain_of_thought]</code> syntax. During execution, LMQL then inserts the instructions and constraints from <code>chain_of_thought</code> into the top-level query, generates a value for <code>ANSWER</code>, and then removes the instructions and constraints again, only returning the final result.</p>
<p><strong>Nested queries are Prompt Function Calls.</strong> This design of nested queries is inspired by the idea of <em>function or procedure calls</em> in traditional programming. Removing intermediate instructions and constraints also has parallels to the idea of <em>stack unwinding</em>, a technique to implement function calls in low-level languages.</p>
<p>LMQL transfers these ideas to prompting, inheriting the general benefits of procedural programming:</p>
<ul>
<li>
<p><strong>Encapsulation and Model Focus</strong> Nested Queries encapsulate and hide the prompting logic used to generate <code>ANSWER</code>, which means our top-level query is much cleaner and more concise. Further, by hiding intermediate instructions from the model in the context of the top-level query, we can reduce noise in the overall prompt, allowing the model to focus on the currently relevant information only, and not get distracted by previous intermediate steps.</p>
</li>
<li>
<p><strong>Nesting and Reuse</strong> LMQL queries can be nested arbitrarily deep, allowing you to reuse and combine queries modularly. For example, you could define a query <code>get_year</code> to extract a year from the response text, and then use this query in <code>chain_of_thought</code> to extract the date from the question. By achieving modularity for sub-prompts, nested queries also allow you to reuse prompts across different query programs.</p>
</li>
</ul>
<p>To learn more about nested queries, please refer to the <a href="./../../docs/language/nestedqueries.html">relevant chapter in the documentation</a>.</p>
<h2 id="generations-api" tabindex="-1">Generations API <a class="header-anchor" href="#generations-api" aria-label="Permalink to &quot;Generations API&quot;">&ZeroWidthSpace;</a></h2>
<p>LMQL 0.7 adds the <em>Generations API</em>, a lightweight high-level library for LMQL-based text generation and scoring. The API was designed to be easy to use and does not require users to write any LMQL themselves:</p>
<div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="hljs"><code><span class="line"><span class="hljs-comment"># obtain a model instance</span>
m: lmql.LLM = lmql.model(<span class="hljs-string">&quot;openai/gpt-3.5-turbo-instruct&quot;</span>)
<span class="hljs-comment"># simple generation</span>
m.generate_sync(<span class="hljs-string">&quot;Hello&quot;</span>, max_tokens=<span class="hljs-number">10</span>)
<span class="hljs-comment"># -&gt; Hello, I am a 23 year old female.</span>
</span></code></pre>
</div><br/>
<p>Functions such as <a href="./../../docs/lib/generations.html#llm-generate"><code>LLM.generate</code></a> and <a href="./../../docs/lib/generations.html#llm-score"><code>LLM.score</code></a> allow you to generate and score text using any LMQL-support inference backend. The Generations API is also seamlessly compatible with standard LMQL, allowing you to switch and combine the two as needed.</p>
<p>For more information, please refer to the <a href="./../../docs/lib/generations.html">documentation</a>.</p>
<h2 id="chat" tabindex="-1">Chat <a class="header-anchor" href="#chat" aria-label="Permalink to &quot;Chat&quot;">&ZeroWidthSpace;</a></h2>
<p>LMQL 0.7 adds a new <a href="./../../docs/lib/chat.html">Chat API</a>, allowing you to easily deploy chatbots with just a couple lines of LMQL.</p>
<img style="max-width: 80vw; width: 400pt; display: block; margin: auto;" src="https://github.com/eth-sri/lmql/assets/17903049/3f24b964-b9b6-4c50-acaa-b38e54554506"/>
<p>LMQL Chat comes with custom output writers, that allow you to easily stream chatbot input and output over a variety of channels, including WebSockets, HTTP, and SSE. A simple <code>lmql chat</code> CLI tool was also added, that allows you to instantly launch your LMQL queries as fully interactive chatbots.</p>
<p>We also provide documentation resources on how to get started with chatbot development with LMQL, including chapters on Chatbot Serving, Internal Reasoning and Defending against Prompt Injection. For more information, please refer to the <a href="./../../docs/lib/chat.html">documentation</a>.</p>
<h2 id="backends" tabindex="-1">Backends <a class="header-anchor" href="#backends" aria-label="Permalink to &quot;Backends&quot;">&ZeroWidthSpace;</a></h2>
<p>LMQL 0.7 ships with three new backends for inference and tokenization:</p>
<ul>
<li>
<p>LMQL 0.7 adds support for OpenAI's newly released <code>gpt-3.5-turbo-instruct</code> model. In contrast to other 3.5 series models, this variant supports the <em>Completions API</em>, which means that LMQL constraints are compatible with it.</p>
</li>
<li>
<p>LMQL now supports hosting models on <a href="https://replicate.com" target="_blank" rel="noreferrer">replicate.com</a> infrastructure, allowing you to run LMQL models in the cloud. To learn more, please refer to the <a href="./../../docs/models/replicate.html">documentation</a>. Thanks a lot to community member <a href="https://github.com/charles-dyfis-net" target="_blank" rel="noreferrer">@charles-dyfis-net</a> for contributing this!</p>
</li>
<li>
<p>LMQL added <code>sentencepiece</code> as an additional tokenization backend, specifically for <code>llama.cpp</code> models. This means, <code>llama.cpp</code> models can now be used without requiring <code>transformers</code> for tokenization. Thanks a lot to community member <a href="https://github.com/khushChopra" target="_blank" rel="noreferrer">@khushChopra</a> for contributing this.</p>
</li>
</ul>
<h2 id="inference-certificates" tabindex="-1">Inference Certificates <a class="header-anchor" href="#inference-certificates" aria-label="Permalink to &quot;Inference Certificates&quot;">&ZeroWidthSpace;</a></h2>
<p>To make LLM inference more transparent and re-producible, LMQL 0.7 also adds <a href="./../../docs/lib/inference-certificates.html"><em>inference certificates</em></a>. An inference certificate is a simple data structure that records essential information needed to reproduce an inference result. Certificates can be generated for any LLM call that happens in an LMQL context.</p>
<p>To produce an inference certificate, pass <code>certificate=True</code> or <code>certificate=&lt;filename&gt;</code> to your query or generate call:</p>
<div class="language-truncated vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">truncated</span><pre class="hljs"><code><span class="line"><span class="hljs-comment"># call and save certificate</span>
say_hello(certificate=<span class="hljs-string">&quot;my-certificate.json&quot;</span>)
</span></code></pre>
</div><p>The resulting certificate file provides a way to document, trace and reproduce LLM inference results by recording the <em>exact (tokenized) prompts</em> and information on the <em>environment and generation parameters</em>.</p>
<p>This can be helpful to better understand what is happening during inference, to debug issues, and to reproduce results. It also offers a way to document LLM failures, to better guide the discussion around the concrete capabilities and limitations of LLMs.</p>
<h2 id="decorators" tabindex="-1">Decorators <a class="header-anchor" href="#decorators" aria-label="Permalink to &quot;Decorators&quot;">&ZeroWidthSpace;</a></h2>
<p><a href="./../../docs/language/decorators.html">Variable Decorators</a> offer a new and simple way to call custom Python functions as part of the core generation loop in LMQL:</p>
<div class="language-lmql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">lmql</span><pre class="hljs"><code><span class="line"><span class="hljs-keyword">def</span> <span class="hljs-title function_">screaming</span>(<span class="hljs-params">value</span>):
    <span class="hljs-string">&quot;&quot;&quot;Decorator to convert a string to uppercase&quot;&quot;&quot;</span>
    <span class="hljs-keyword">return</span> value.upper()

<span class="hljs-string">&quot;Say &#x27;this is a test&#x27;:<span class="hljs-placeholder">[@screaming TEST]</span>&quot;</span>
</span></code></pre>
</div><div class="language-promptdown vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">promptdown</span><pre pd-text="Say 'this is a test': [TEST| THIS IS A TEST]
" animate="true" __animate="true" animate-speed="50" class="promptdown promptdown-compiled" style="opacity: 1;"><p pd-shadow-id="2447" text="S" pd-insertion-point="true">Say 'this is a test': <span pd-shadow-id="2449" pd-instant="false" text="" class="promptdown-var color-pink"><span pd-shadow-id="2450" text="T" class="promptdown-var-name">TEST</span> THIS IS A TEST</span>
</p></pre>
</div><p>Similar to Python decorators, LMQL decorators are functions that take a variable as input and can wrap and modify its value.</p>
<p>In the example above, we use the <code>@screaming</code> decorator to convert the value of <code>TEST</code> to uppercase. Decorators can be used to implement a wide range of custom functionality, including string normalization, datatype conversion, and more. LMQL also provides decorators that allow to stream or pre-process data during generation. For more information, please refer to the <a href="./../../docs/language/decorators.html">documentation</a>.</p>
<h2 id="documentation-update" tabindex="-1">Documentation Update <a class="header-anchor" href="#documentation-update" aria-label="Permalink to &quot;Documentation Update&quot;">&ZeroWidthSpace;</a></h2>
<p>The website and many chapters of the LMQL documentation have also been updated and extended and now include more examples and explanations. We have updated the visual design to make it easier to read and navigate.</p>
<p>The documentation now also includes a <em>work-in-progress</em> <a href="/docs/language/reference.html">Language Reference</a>, which aims to provide a more comprehensive and formal description of LMQL's syntax and semantics, all in one place.</p>
<h2 id="preview-features" tabindex="-1">Preview Features <a class="header-anchor" href="#preview-features" aria-label="Permalink to &quot;Preview Features&quot;">&ZeroWidthSpace;</a></h2>
<p>Apart from many new core features, LMQL 0.7 also ships with several <em>experimental preview features</em>, allowing you to test drive new functionality before it has fully stabilized and is released as main-line functionality.</p>
<p>These features are marked as <em>experimental</em> and are not yet fully supported. We are releasing them to gather feedback and to allow users to test them out early on. Note that these features are subject to change and may be removed/modified in future releases.</p>
<h3 id="lmql-actions-preview" tabindex="-1">LMQL Actions <span class="beta badge">Preview</span> <a class="header-anchor" href="#lmql-actions-preview" aria-label="Permalink to &quot;LMQL Actions &lt;span class=&quot;beta badge&quot;&gt;Preview&lt;/span&gt;&quot;">&ZeroWidthSpace;</a></h3>
<p><em>LMQL Actions</em> is the first version of LMQL's function calling layer. It allows you to expose arbitrary Python functions to the LLM reasoning loop and lets the model call them during generation. Function demonstration and the calling protocol can be both handled automatically by the LMQL runtime, allowing for simple use like this:</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="hljs"><code><span class="line"><span class="hljs-keyword">def</span> <span class="hljs-title function_">wiki</span>(<span class="hljs-params">q</span>): ...
<span class="hljs-keyword">def</span> <span class="hljs-title function_">calc</span>(<span class="hljs-params">expr</span>): ...

<span class="hljs-string">&quot;Q: What is the population of the US and Germany combined?&quot;</span>
<span class="hljs-string">&quot;A: <span class="hljs-placeholder">[REASONING]</span>&quot;</span> <span class="hljs-keyword">where</span> inline_use(REASONING, [wiki, calc])
</span></code></pre>
</div><p>A future release will bring more documentation and details on Actions, including how to use and customize it for your use cases. Until then we invite everyone to try and hack with the current implementation, fully contained in <a href="https://github.com/eth-sri/lmql/blob/main/src/lmql/lib/actions.py" target="_blank" rel="noreferrer"><code>actions.py</code></a>.</p>
<h3 id="regex-constraints-preview" tabindex="-1">Regex Constraints <span class="beta badge">Preview</span> <a class="header-anchor" href="#regex-constraints-preview" aria-label="Permalink to &quot;Regex Constraints &lt;span class=&quot;beta badge&quot;&gt;Preview&lt;/span&gt;&quot;">&ZeroWidthSpace;</a></h3>
<p>LMQL now has support for regex constraints, allowing you to use regular expressions to constrain the output of a variable. For example, the following query will always generate a valid date of the form <code>DD/MM</code>:</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="hljs"><code><span class="line"><span class="hljs-string">&quot;It&#x27;s the last day of June so today is <span class="hljs-placeholder">[RESPONSE]</span>&quot;</span> <span class="hljs-keyword">where</span> REGEX(RESPONSE, r<span class="hljs-string">&quot;<span class="hljs-placeholder">[<span class="hljs-number">0</span>-<span class="hljs-number">9</span>]</span><span class="hljs-subst">{<span class="hljs-number">2</span>}</span>/<span class="hljs-placeholder">[<span class="hljs-number">0</span>-<span class="hljs-number">9</span>]</span><span class="hljs-subst">{<span class="hljs-number">2</span>}</span>&quot;</span>)
</span></code></pre>
</div><h3 id="types-datatype-constraints-preview" tabindex="-1">Types / Datatype Constraints <span class="beta badge">Preview</span> <a class="header-anchor" href="#types-datatype-constraints-preview" aria-label="Permalink to &quot;Types / Datatype Constraints &lt;span class=&quot;beta badge&quot;&gt;Preview&lt;/span&gt;&quot;">&ZeroWidthSpace;</a></h3>
<p>LMQL is moving towards fully typed LLM generation. On the way there, we have started to add support for <em>dataclass constraints</em>, allowing you to constrain the output of a variable to a specific structured output schema:</p>
<div class="language-lmql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">lmql</span><pre class="hljs"><code><span class="line"><span class="hljs-keyword">import</span> lmql
<span class="hljs-keyword">from</span> dataclasses <span class="hljs-keyword">import</span> dataclass

<span class="hljs-meta">@dataclass</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span>:
    name: <span class="hljs-built_in">str</span>
    age: <span class="hljs-built_in">int</span>
    job: <span class="hljs-built_in">str</span>

<span class="hljs-string">&quot;Alice is a 21 years old and works as an engineer at LMQL Inc in Zurich, Switzerland.\n&quot;</span>
<span class="hljs-string">&quot;Structured: <span class="hljs-placeholder">[PERSON_DATA]</span>\n&quot;</span> <span class="hljs-keyword">where</span> <span class="hljs-built_in">type</span>(PERSON_DATA) <span class="hljs-keyword">is</span> Person

PERSON_DATA
<span class="hljs-comment"># Person(name=&#x27;Alice&#x27;, age=21, job=&#x27;engineer&#x27;)</span>
</span></code></pre>
</div><p>To achieve this, LMQL leverages constrained generation to make sure the LLM always produces all information required to populate a valid <code>Person</code> object. The resulting <code>PERSON_DATA</code> object can then be directly used like a regular Python object. Types are still in an early stage and we are working on adding more features and functionality.</p>
<h2 id="other-changes" tabindex="-1">Other Changes <a class="header-anchor" href="#other-changes" aria-label="Permalink to &quot;Other Changes&quot;">&ZeroWidthSpace;</a></h2>
<ul>
<li>
<p>The LMQL playground can now be used from the Windows <code>cmd.exe</code>. Thanks a lot to community member <a href="https://github.com/mosheduminer" target="_blank" rel="noreferrer">@mosheduminer</a>.</p>
</li>
<li>
<p>LMQL/LMTP model backends can now be accessed <a href="https://github.com/eth-sri/lmql/blob/main/src/lmql/models/lmtp/lmtp_langchain.py" target="_blank" rel="noreferrer">as Langchain <code>LLM</code> objects</a> to use them in your Langchain pipelines. Thanks to <a href="https://github.com/4onon" target="_blank" rel="noreferrer">@4onon</a> for contributing this.</p>
</li>
<li>
<p>LMQL can now be <a href="https://github.com/eth-sri/lmql/tree/main/scripts/flake.d" target="_blank" rel="noreferrer">installed as a NixOS package</a>. Thanks to <a href="https://github.com/charles-dyfis-net" target="_blank" rel="noreferrer">@charles-dyfis-net</a> for contributing this.</p>
</li>
</ul>
<h2 id="üé¨-and-that-s-a-wrap" tabindex="-1">üé¨ And that's a wrap! <a class="header-anchor" href="#üé¨-and-that-s-a-wrap" aria-label="Permalink to &quot;üé¨ And that's a wrap!&quot;">&ZeroWidthSpace;</a></h2>
<p>LMQL 0.7 is a big release and we are excited to see what you will build with it. As always, please let us know if you have any questions, suggestions or bug reports, on <a href="https://github.com/eth-sri/lmql" target="_blank" rel="noreferrer">GitHub</a>, <a href="https://discord.gg/7eJP4fcyNT" target="_blank" rel="noreferrer">Discord</a>, <a href="https://twitter.com/lmqllang" target="_blank" rel="noreferrer">Twitter</a> or via <a href="mailto:hello@lmql.ai" target="_blank" rel="noreferrer">hello@lmql.ai</a>.</p>
</div></div></div><div class="posts" data-v-61c06c99><div class="post" data-v-61c06c99><a href="/blog/posts/release-0.0.6.6.html" data-v-61c06c99><h1 data-v-61c06c99>LMQL v0.0.6.6</h1></a><div class="body" data-v-61c06c99><p><span class="date">July 25, 2023</span></p>
<p>We just released LMQL <em>0.0.6.6</em>. This is a minor update with a couple of smaller fixes and improvements.</p>
<ul>
<li><code>lmql.F</code> now supports positional arguments:</li>
</ul>
<div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="hljs"><code><span class="line">greet = lmql.F(<span class="hljs-string">&quot;Greet <span class="hljs-subst">{a}</span> and <span class="hljs-subst">{b}</span>: <span class="hljs-placeholder">[GREETING]</span>&quot;</span>)

<span class="hljs-comment"># call with positional arguments</span>
greet(<span class="hljs-string">&quot;Alice&quot;</span>, <span class="hljs-string">&quot;Bob&quot;</span>) <span class="hljs-comment"># Greet Alice and Bob: Hello!</span>
<span class="hljs-comment"># call with keyword arguments</span>
greet(a=<span class="hljs-string">&quot;Alice&quot;</span>, b=<span class="hljs-string">&quot;Bob&quot;</span>) <span class="hljs-comment"># Greet Alice and Bob: Hello!</span>
</span></code></pre>
</div><ul>
<li>
<p>We improved the error handling of the <code>llama.cpp</code> backend and fixed a bug with model identifier parsing.</p>
</li>
<li>
<p>We also fixed a bug with the LMTP scheduler, where CPU load was high even when no tasks were present. Thanks to community member <a href="https://github.com/4onen" target="_blank" rel="noreferrer">@4onen</a> for reporting and fixing this!</p>
</li>
<li>
<p>Added backend support for <code>auto_gptq</code> quantized models, contributed by community member <a href="https://github.com/meditans" target="_blank" rel="noreferrer">@meditans</a>.</p>
</li>
<li>
<p>We fixed an issue where for Azure OpenAI models, a dummy configuration <code>api.env</code> was needed. See our <a href="./../../docs/models/azure.html">documentation</a> for details. Thanks to community members Missing and <a href="https://github.com/hooman-bayer" target="_blank" rel="noreferrer">@hooman-bayer</a> for their feedback and contributions to this.</p>
</li>
</ul>
<blockquote>
<p><strong>Versioning Note</strong>: 0.0.6.6 is the last release with two leading zeros. Starting with the next release, LMQL will adopt semantic versioning and use a single leading zero, i.e. 0.6.7.</p>
</blockquote>
</div></div></div><div class="posts" data-v-61c06c99><div class="post" data-v-61c06c99><a href="/blog/posts/release-0.0.6.5.html" data-v-61c06c99><h1 data-v-61c06c99>LMQL becomes simpler and adds llama.cpp</h1></a><div class="body" data-v-61c06c99><h1 id="lmql-becomes-simpler-and-adds-llama-cpp" tabindex="-1">LMQL becomes simpler and adds llama.cpp <a class="header-anchor" href="#lmql-becomes-simpler-and-adds-llama-cpp" aria-label="Permalink to &quot;LMQL becomes simpler and adds llama.cpp&quot;">&ZeroWidthSpace;</a></h1>
<p><span class="date">July 13, 2023</span></p>
<p>Today we are releasing LMQL 0.0.6.5. This update contains a major simplification of the LMQL syntax, moving it much closer to standard Python. It also includes a <code>llama.cpp</code> based inference backend, several bug fixes and other minor improvements.</p>
<p>You can try the latest version of LMQL in your browser at <a href="https://lmql.ai/playground" target="_blank" rel="noreferrer">lmql.ai/playground</a> or install it via <code>pip install lmql</code>.</p>
<h2 id="one-line-is-all-it-takes" tabindex="-1">One Line Is All It Takes <a class="header-anchor" href="#one-line-is-all-it-takes" aria-label="Permalink to &quot;One Line Is All It Takes&quot;">&ZeroWidthSpace;</a></h2>
<p>Most notably, 0.0.6.5 comes with several simplifications of the core syntax of LMQL. Of course, all changes are backwards compatible, so you can continue to use your existing query code and move to the new version without any changes.</p>
<p>With this, we aim to minimize syntactic overhead, employing sensible defaults to enable more concise programs like the following:</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="hljs"><code><span class="line"><span class="hljs-string">&quot;One line is all it takes <span class="hljs-placeholder">[CONTINUATION]</span>&quot;</span>
</span></code></pre>
</div><div class="language-promptdown vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">promptdown</span><pre pd-text="One line is all it takes [CONTINUATION|Fallin' in love with me.]
" animate="true" __animate="true" animate-speed="50" class="promptdown promptdown-compiled" style="opacity: 1;"><p pd-shadow-id="2396" text="O" pd-insertion-point="true">One line is all it takes <span pd-shadow-id="2398" pd-instant="false" text="" class="promptdown-var color-pink"><span pd-shadow-id="2399" text="C" class="promptdown-var-name">CONTINUATION</span>Fallin' in love with me.</span>
</p></pre>
</div><p><strong>Sensible Defaults</strong> This is possible because LMQL now automatically assumes <code>argmax</code> and <code>openai/text-davinci-003</code> as (configurable) default model. If you prefer to use
a different model or custom decoder settings, you can still specify them explicitly, e.g. in the <code>@lmql.query</code> decorator function as demonstrated later in this post.</p>
<p>Without any additional configuration, the simple query code above translates to a full LMQL program like this:</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="hljs"><code><span class="line"><span class="hljs-keyword">argmax</span> <span class="hljs-string">&quot;One line is all it takes <span class="hljs-placeholder">[CONTINUATION]</span>&quot;</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;openai/text-davinci-003&quot;</span>
</span></code></pre>
</div><br/>
<h3 id="inline-constraints" tabindex="-1">Inline Constraints <a class="header-anchor" href="#inline-constraints" aria-label="Permalink to &quot;Inline Constraints&quot;">&ZeroWidthSpace;</a></h3>
<p>LMQL now allows you to specify several inline <code>where</code> constraints. This enables constraints that refer to local program variables, which means constraints can now be dependent on previous model outputs.</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="hljs"><code><span class="line"><span class="hljs-string">&quot;A list of awesome Dua Lipa songs:\n&quot;</span>
songs = []

<span class="hljs-string">&quot;- New Rules\n&quot;</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):
    <span class="hljs-string">&quot;-<span class="hljs-placeholder">[SONG]</span>\n&quot;</span> <span class="hljs-keyword">where</span> STOPS_BEFORE(SONG, <span class="hljs-string">&quot;\n&quot;</span>)
    songs.append(SONG)

<span class="hljs-string">&quot;Out of these, my favorite is<span class="hljs-placeholder">[FAVORITE]</span>&quot;</span> <span class="hljs-keyword">where</span> FAVORITE <span class="hljs-keyword">in</span> songs
</span></code></pre>
</div><div class="language-promptdown vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">promptdown</span><pre pd-text="A list of awesome Dua Lipa songs:‚èé
- New Rules
- [SONG|Don't Start Now]
- [SONG|IDGAF]
- [SONG|Be the One]
- [SONG|Blow Your Mind (Mwah)]
Out of these, my favorite is [FAVORITE|Don't Start Now]
" animate="true" __animate="true" animate-speed="50" class="promptdown promptdown-compiled" style="opacity: 1;"><p pd-shadow-id="2405" text="A" pd-insertion-point="true">A list of awesome Dua Lipa songs:‚èé
- New Rules
- <span pd-shadow-id="2407" pd-instant="false" text="" class="promptdown-var color-pink"><span pd-shadow-id="2408" text="S" class="promptdown-var-name">SONG</span>Don't Start Now</span>
- <span pd-shadow-id="2413" pd-instant="false" text="" class="promptdown-var color-pink"><span pd-shadow-id="2414" text="S" class="promptdown-var-name">SONG</span>IDGAF</span>
- <span pd-shadow-id="2419" pd-instant="false" text="" class="promptdown-var color-pink"><span pd-shadow-id="2420" text="S" class="promptdown-var-name">SONG</span>Be the One</span>
- <span pd-shadow-id="2425" pd-instant="false" text="" class="promptdown-var color-pink"><span pd-shadow-id="2426" text="S" class="promptdown-var-name">SONG</span>Blow Your Mind (Mwah)</span>
Out of these, my favorite is <span pd-shadow-id="2431" pd-instant="false" text="" class="promptdown-var color-ochre"><span pd-shadow-id="2432" text="F" class="promptdown-var-name">FAVORITE</span>Don't Start Now</span>
</p></pre>
</div><p>Note also how in this example LMQL code now reads much more like standard Python code, without any additional level of indentation.</p>
<br/>
<h3 id="lmql-query-functions" tabindex="-1"><code>@lmql.query</code> functions <a class="header-anchor" href="#lmql-query-functions" aria-label="Permalink to &quot;`@lmql.query` functions&quot;">&ZeroWidthSpace;</a></h3>
<p>The overhauled syntax also makes LMQL much  easier on the eyes when used with the <code>@lmql.query</code> <a href="/docs/lib/python.html">function decorator in Python</a>:</p>
<div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="hljs"><code><span class="line"><span class="hljs-keyword">import</span> lmql
<span class="hljs-keyword">import</span> json

<span class="hljs-meta">@lmql.query(<span class="hljs-params">model=<span class="hljs-string">&quot;openai/text-curie-001&quot;</span>, temperature=<span class="hljs-number">0.9</span></span>)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">summarize</span>(): 
    <span class="hljs-inline-lmql"><span style='opacity: 0.4'>&#x27;&#x27;&#x27;lmql</span>
    <span class="hljs-string">&quot;&quot;&quot;
    Provide a summary of Dua Lipa, the pop icon:
    <span v-pre>{{</span>
      &quot;name&quot;: &quot;<span class="hljs-placeholder">[STRING_VALUE]</span>&quot;,
      &quot;chart_position&quot;: <span class="hljs-placeholder">[INT_VALUE]</span>,
      &quot;top_songs&quot;: <span class="hljs-placeholder">[[
         <span class="hljs-string">&quot;[STRING_VALUE]&quot;</span>,
         <span class="hljs-string">&quot;[STRING_VALUE]&quot;</span>
      ]</span>]
    }}
    &quot;&quot;&quot;</span> <span class="hljs-keyword">where</span> STOPS_BEFORE(STRING_VALUE, <span class="hljs-string">&#x27;&quot;&#x27;</span>) <span class="hljs-keyword">and</span> INT(INT_VALUE) <span class="hljs-keyword">and</span> <span class="hljs-built_in">len</span>(TOKENS(INT_VALUE)) &lt; 3
    
    <span class="hljs-keyword">return</span> json.loads(context.prompt.split(<span class="hljs-string">&quot;pop icon:&quot;</span>,1)[1])
    &#x27;&#x27;&#x27;</span>

<span class="hljs-built_in">print</span>(summarize()) <span class="hljs-comment"># {&#x27;name&#x27;: &#x27;Dua Lipa&#x27;, &#x27;chart_position&#x27;: 3415, &#x27;top_songs&#x27;: [&#x27;New Rules&#x27;, &#x27;Havana&#x27;]}</span>

</span></code></pre>
</div><br/>
<h3 id="lmql-f-lambda-functions" tabindex="-1"><code>lmql.F</code> Lambda Functions <a class="header-anchor" href="#lmql-f-lambda-functions" aria-label="Permalink to &quot;`lmql.F` Lambda Functions&quot;">&ZeroWidthSpace;</a></h3>
<p>Based on LMQL's new minimal syntax, we introduce a novel and concise way to write LLM-based lambda functions. This offers a lightweight entryway to get started with integrated small LLM-based utilities in your code, without having to write a full LMQL program.</p>
<div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="hljs"><code><span class="line"><span class="hljs-keyword">import</span> lmql

summarize = lmql.F(<span class="hljs-string">&quot;Summarize the following in a few words: <span class="hljs-subst">{data}</span>: <span class="hljs-placeholder">[SUMMARY]</span>&quot;</span>)
main_subject = lmql.F(<span class="hljs-string">&quot;What is the main subject (noun) of the following text? <span class="hljs-subst">{data}</span>: <span class="hljs-placeholder">[SUBJECT]</span>&quot;</span>, 
                      <span class="hljs-string">&quot;len(TOKENS(SUBJECT)) &lt; 20&quot;</span>)

text = <span class="hljs-string">&quot;In LMQL, users can specify high-level, logical constraints ...&quot;</span>

summarize(data=text) <span class="hljs-comment"># LMQL enables high-level constraints to be enforced during text </span>
                     <span class="hljs-comment"># generation, simplifying multi-part prompting and integration.</span>
main_subject(data=text) <span class="hljs-comment"># Language Model Query Language (LMQL)</span>

</span></code></pre>
</div><br/>
<br/>
<h2 id="llama-cpp-inference-backend" tabindex="-1"><code>llama.cpp</code> Inference Backend <a class="header-anchor" href="#llama-cpp-inference-backend" aria-label="Permalink to &quot;`llama.cpp` Inference Backend&quot;">&ZeroWidthSpace;</a></h2>
<p>LMQL now also fully integrates with the excellent <a href="https://github.com/ggerganov/llama.cpp" target="_blank" rel="noreferrer">llama.cpp</a> C++ implementation of a number of Transformer-based language models.</p>
<p>Using <code>llama.cpp</code> from LMQL is as simple as specifying it in the <code>from</code> clause of a query:</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="hljs"><code><span class="line"><span class="hljs-keyword">argmax</span> <span class="hljs-string">&quot;Say &#x27;this is a test&#x27;:<span class="hljs-placeholder">[RESPONSE]</span>&quot;</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;llama.cpp:&lt;PATH TO WEIGHTS&gt;.bin&quot;</span>
</span></code></pre>
</div><p>We support, both, in-process loading of <code>llama.cpp</code>, as well as remote inference via <code>lmql serve-model</code>. To learn more about <code>llama.cpp</code> and how to use it with LMQL, check out the corresponding chapter in the LMQL <a href="/docs/models/llama.cpp.html">documentation</a>.</p>
<br/>
<h2 id="other-changes" tabindex="-1">Other Changes <a class="header-anchor" href="#other-changes" aria-label="Permalink to &quot;Other Changes&quot;">&ZeroWidthSpace;</a></h2>
<ul>
<li>
<p>LMQL now includes a <code>random</code> model backend, which randomly samples tokens from the GPT-2 vocabulary. This is useful for debugging and testing purposes and can be used for data generation in the context of highly constrained query programs.</p>
</li>
<li>
<p>Two caching issues have been fixed, avoiding cache collisions which could lead to repeated model outputs.</p>
</li>
<li>
<p>More robust query string parsing, allowing for <a href="/docs/language/scripted-prompting.html#escaping">robust escaping</a> of special characters <code>[</code>, <code>]</code>, <code>{</code> and <code>}</code>.</p>
</li>
<li>
<p>Added support for <code>transformers</code> based Llama models and the associated (fast) implementation of HF tokenizers.</p>
</li>
<li>
<p>Simplified Azure OpenAI support, see the relevant chapter in the <a href="/docs/models/azure.html">documentation</a>.</p>
</li>
</ul>
<p>We thank community members <a href="https://github.com/minosvasilias" target="_blank" rel="noreferrer">@minosvasilias</a> and <a href="https://github.com/CircArgs" target="_blank" rel="noreferrer">@CircArgs</a> for their contribution to this release.</p>
</div></div></div><div class="posts" data-v-61c06c99><div class="post" data-v-61c06c99><a href="/blog/posts/release-0.0.6.4.html" data-v-61c06c99><h1 data-v-61c06c99>Releasing LMQL v0.0.6.4 LMTP, Azure, Synchronous API, and more</h1></a><div class="body" data-v-61c06c99><h1 id="releasing-lmql-0-0-6-4-lmtp-azure-synchronous-api-and-more" tabindex="-1">Releasing LMQL 0.0.6.4: LMTP, Azure, Synchronous API, and more <a class="header-anchor" href="#releasing-lmql-0-0-6-4-lmtp-azure-synchronous-api-and-more" aria-label="Permalink to &quot;Releasing LMQL 0.0.6.4: LMTP, Azure, Synchronous API, and more&quot;">&ZeroWidthSpace;</a></h1>
<p><span class="date">June 8, 2023</span></p>
<p>Among many things, this update contains several bug fixes and improvements. The most notable changes are:</p>
<ul>
<li>
<p><strong>Azure OpenAI support</strong> LMQL now supports OpenAI models that are served via Azure. For more information on how to use Azure models, please see the corresponding chapter in the <a href="/docs/models/azure.html">documentation</a>. Many thanks to <a href="https://github.com/veqtor" target="_blank" rel="noreferrer">@veqtor</a> for contributing this feature.</p>
</li>
<li>
<p><strong>Local Models via the Language Model Transport Protocol</strong> LMQL 0.0.6.4 implements a novel protocol to stream token output from local models, vastly improving performance. In our first benchmarks, we observed a 5-6x speedup for local model inference. For more information on how to use local models, please see the corresponding chapter in the <a href="/docs/models/hf.html">documentation</a>.</p>
<p>To learn more about the internals of the new streaming protocol, i.e. the language model transport protocol (LMTP), you can find more details in <a href="https://github.com/eth-sri/lmql/blob/main/src/lmql/models/lmtp/README.md" target="_blank" rel="noreferrer">this README file</a>. In the future, we intend to implement more model backends using LMTP, streamlining communication between LMQL and models.</p>
 <div style="text-align:center">
  <img src="https://docs.lmql.ai/en/stable/_images/inference.svg" width="80%" />
  <br>
  <i>LMQL's new streaming protocol (LMTP) allows for faster local model inference.</i>
 </div>
</li>
<li>
<p><strong>Synchronous Python API</strong> Next to an <code>async/await</code> based API, LMQL now also provides a synchronous API. This means you no longer need to use <code>asyncio</code> to use LMQL from Python.</p>
<p>To use the synchronous API, simply declare <code>@lmql.query</code> function without the <code>async</code> keyword, e.g.</p>
<div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="hljs"><code><span class="line"><span class="hljs-keyword">import</span> lmql

<span class="hljs-meta">@lmql.query</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">hello</span>(<span class="hljs-params">s: <span class="hljs-built_in">str</span></span>):
    <span class="hljs-inline-lmql"><span style='opacity: 0.4'>&#x27;&#x27;&#x27;lmql</span>
    <span class="hljs-keyword">argmax</span> 
        <span class="hljs-string">&quot;Hello <span class="hljs-subst">{s}</span> <span class="hljs-placeholder">[RESPONSE]</span>&quot;</span> 
        <span class="hljs-keyword">return</span> RESPONSE
    <span class="hljs-keyword">from</span> 
        <span class="hljs-string">&quot;chatgpt&quot;</span>
    &#x27;&#x27;&#x27;</span>

<span class="hljs-built_in">print</span>(hello(<span class="hljs-string">&quot;world&quot;</span>)) <span class="hljs-comment"># [&#x27;Hello! How can I assist you today?&#x27;]</span>
</span></code></pre>
</div><p>If you instead want to use <code>lmql.run</code> in a synchronous context, you can now use <code>lmql.run_sync</code> instead. To learn more about how LMQL can be used from Python, check out our <a href="/docs/lib/python.html">documentation</a>.</p>
</li>
<li>
<p><strong>Improved Tokenizer Backends</strong> LMQL can now use the excellent <a href="https://github.com/openai/tiktoken" target="_blank" rel="noreferrer"><code>tiktoken</code> tokenizer</a> as tokenization backend (for OpenAI models). Furthermore, all tokenization backends have been ported to operate on a byte-level, which improves support for multibyte characters and emojis. This is especially relevant for non-English languages and special characters.</p>
</li>
<li>
<p><strong>Docker Image</strong> LMQL now provides a Docker image that can be used to run the LMQL playground in a containerized environment. For more information, please see the <a href="/docs/development/docker-setup.html">documentation</a>. Many thanks to <a href="https://github.com/SilacciA" target="_blank" rel="noreferrer">@SilacciA</a> for contributing this feature.</p>
</li>
<li>
<p><strong>Faster Startup Time</strong> We optimized LMQL's import hierarchy, which results in faster module loading time.</p>
</li>
</ul>
</div></div></div><div class="posts" data-v-61c06c99><div class="post" data-v-61c06c99><a href="/blog/posts/release-0.0.6.3.html" data-v-61c06c99><h1 data-v-61c06c99>LMQL Release v0.0.6.3</h1></a><div class="body" data-v-61c06c99><h1 id="lmql-v0-0-6-3" tabindex="-1">LMQL v0.0.6.3 <a class="header-anchor" href="#lmql-v0-0-6-3" aria-label="Permalink to &quot;LMQL v0.0.6.3&quot;">&ZeroWidthSpace;</a></h1>
<p><span class="date">May 11, 2023</span></p>
<p>Today, we are releasing LMQL v0.0.6.3. This update contains several bug fixes and improvements. The most notable changes are:</p>
<ul>
<li>
<p><strong>Lighter Runtime</strong> As part of our continued efforts, we made LMQL much lighter (no more mandatory <code>transformers</code> dependency). By default LMQL now no longer requires <code>transformers</code> or PyTorch. If you rely on local models, just install LMQL via <code>pip install lmql[hf]</code> to get full Transformers integration.</p>
</li>
<li>
<p><strong>Token Constraints</strong> A new function <code>TOKENS(...)</code> was added to the LMQL constraint language, allowing you to specify lower and upper bounds or the exact number of tokens to generate for a given variable.</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="hljs"><code><span class="line"><span class="hljs-keyword">argmax</span> 
    <span class="hljs-string">&quot;A 10 token response<span class="hljs-placeholder">[WHO]</span>&quot;</span> 
<span class="hljs-keyword">from</span> 
    <span class="hljs-string">&quot;openai/text-ada-001&quot;</span> 
<span class="hljs-keyword">where</span> 
    <span class="hljs-built_in">len</span>(TOKENS(WHO)) == <span class="hljs-number">10</span>
</span></code></pre>
</div></li>
<li>
<p><strong>Conditional Stopping</strong> <code>STOPS_AT</code> can now be combined with additional side conditions. This allows you to specify stopping phrases that are only enforced, once other conditions are met.</p>
<p>For example, below, we stop when the generated text hits a newline character, but only if the overall variable output is already at least 10 tokens long.</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="hljs"><code><span class="line"><span class="hljs-keyword">argmax</span> 
    <span class="hljs-string">&quot;Hello<span class="hljs-placeholder">[WHO]</span>&quot;</span> 
<span class="hljs-keyword">from</span> 
    <span class="hljs-string">&quot;openai/text-ada-001&quot;</span> 
<span class="hljs-keyword">where</span> 
    <span class="hljs-built_in">len</span>(TOKENS(WHO)) &gt; <span class="hljs-number">10</span> <span class="hljs-keyword">and</span> STOPS_AT(WHO, <span class="hljs-string">&quot;\n&quot;</span>)
</span></code></pre>
</div></li>
<li>
<p><strong>lmql.run</strong>: Improved input validation for <code>lmql.run</code> as contributed by <a href="https://twitter.com/lfegray" target="_blank">@lfegray</a>. More specifically, <code>lmql.run</code> wil now provide more helpful error messages when client logic does not specify input values for all required query parameters.</p>
</li>
<li>
<p><strong>Automatic Cache Invalidation</strong>: LMQL's tokenizer cache at <code>~/.cache/lmql</code> is now invalidated automatically when upgrading to a new version. This should prevent issues with outdated cache files.</p>
</li>
</ul>
<blockquote>
<p>Note: Version 0.0.6.2 was skipped and yanked from pypi.org, as an invalid release was pushed accidentally.</p>
</blockquote>
</div></div></div><div class="posts" data-v-61c06c99><div class="post" data-v-61c06c99><a href="/blog/posts/release-0.0.6.1.html" data-v-61c06c99><h1 data-v-61c06c99>LMQL Release v0.0.6.1</h1></a><div class="body" data-v-61c06c99><h1 id="lmql-v0-0-6-1" tabindex="-1">LMQL v0.0.6.1 <a class="header-anchor" href="#lmql-v0-0-6-1" aria-label="Permalink to &quot;LMQL v0.0.6.1&quot;">&ZeroWidthSpace;</a></h1>
<p><span class="date">May 3, 2023</span></p>
<p>We released LMQL v0.0.6.1, which contains several bug fixes and improvements. The most notable changes are:</p>
<ul>
<li>
<p><strong>Cache Layer Bug Fixes</strong> This release contains several fixes and improvements to the recently introduced cache layer.</p>
</li>
<li>
<p><strong>Stopping Phrases</strong> Stopping phrases specified via <code>STOPS_BEFORE</code> are now passed to the OpenAI API as <code>&quot;stop&quot;</code> parameter, decreasing the number of tokens used for the request. If you want to disable this (e.g. to allow speculative execution), you can specify the new decoder parameter <code>openai_nonstop=True</code>.</p>
</li>
<li>
<p><strong>Asynchronous Output Writers</strong> All output writers have been refactored to use asynchronous I/O. This should simplify integration with other asynchronous frameworks, e.g. for HTTP or Websocket APIs. We also added a new chapter on <a href="/docs/lib/output.html">Output Streaming</a> to the documentation.</p>
</li>
<li>
<p><strong>Output Writers for HTTP endpoints, WebSockets and Server-Sent Events</strong> Based on the updated output writer interface, we added three new output writers for serving LMQL queries as HTTP endpoints, WebSockets and via Server-Sent Events (SSE). To learn more, check their relatively simple implementations in the new <a href="https://github.com/eth-sri/lmql/tree/main/src/lmql/output" target="_blank" rel="noreferrer">lmql.output</a> module. We will also provide more documentation on how to use them, e.g. with <code>aiohttp</code> in the future.</p>
</li>
</ul>
</div></div></div><div class="posts" data-v-61c06c99><div class="post" data-v-61c06c99><a href="/blog/posts/release-0.0.6.html" data-v-61c06c99><h1 data-v-61c06c99>Releasing the LMQL Caching Layer (v0.0.6)</h1></a><div class="body" data-v-61c06c99><h1 id="releasing-the-lmql-caching-layer-v0-0-6" tabindex="-1">Releasing the LMQL Caching Layer (v0.0.6) <a class="header-anchor" href="#releasing-the-lmql-caching-layer-v0-0-6" aria-label="Permalink to &quot;Releasing the LMQL Caching Layer (v0.0.6)&quot;">&ZeroWidthSpace;</a></h1>
<p><span class="date">May 1, 2023</span></p>
<p>Today we are releasing LMQL 0.0.6, the first version of LMQL that integrates the <em>LMQL Caching Layer</em>. The caching layer can drastically reduce token use of LLM interaction, lowering both the cost and latency of running queries. In this blog post, we provide a quick overview of the caching layer and demonstrate how it can reduce token use, latency and the number of requests needed to run queries by up to 80%. We observe improvements across a wide range of different scenarios, including <strong>template-based queries, long-form constraints and tool augmentation.</strong></p>
<p>You can experiment with LMQL in the browser-based <a href="http://lmql.ai/playground" target="_blank" rel="noreferrer">Playground IDE</a> or install the latest version locally, via <code>pip install lmql</code>.</p>
<h2 id="caching-layer" tabindex="-1">Caching Layer <a class="header-anchor" href="#caching-layer" aria-label="Permalink to &quot;Caching Layer&quot;">&ZeroWidthSpace;</a></h2>
<p>The caching layer is implemented as a <strong>tree-based data structure</strong> that caches all model output including logits, tokens, and metadata, allowing the runtime to more efficiently explore the token space of an LLM, even in the presence of multiple variables, constraints and tool augmentation. The cache can be considered an append-only tree, that is explored during query execution, expanding branches according to query code, constraints and speculative execution.</p>
<p>To illustrate the effect of a caching layer, we consider the following example scenarios, all of which now run in a fraction of the time and with a fraction of the tokens needed with traditional querying methods.</p>
<h3 id="template-based-queries" tabindex="-1">Template-Based Queries <a class="header-anchor" href="#template-based-queries" aria-label="Permalink to &quot;Template-Based Queries&quot;">&ZeroWidthSpace;</a></h3>
<p>When specifying a prompt template with multiple variables to fill in, an LLM typically needs to be invoked once per variable. For instance, consider the following template that guides an LLM in generating a list of things:</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="hljs"><code><span class="line"><span class="hljs-keyword">argmax</span>
    <span class="hljs-string">&quot;A list of things not to forget when going to the sea (not travelling): \n&quot;</span>
    <span class="hljs-string">&quot;- Sunglasses \n&quot;</span>
    <span class="hljs-string">&quot;-<span class="hljs-placeholder">[THING]</span>&quot;</span>
    <span class="hljs-string">&quot;-<span class="hljs-placeholder">[THING]</span>&quot;</span>
    <span class="hljs-string">&quot;-<span class="hljs-placeholder">[THING]</span>&quot;</span>
    <span class="hljs-string">&quot;-<span class="hljs-placeholder">[THING]</span>&quot;</span>
<span class="hljs-keyword">from</span>
    <span class="hljs-string">&#x27;openai/text-ada-001&#x27;</span>
<span class="hljs-keyword">where</span>
    STOPS_AT(THING, <span class="hljs-string">&quot;\n&quot;</span>)
</span></code></pre>
</div><p><strong>Without Caching:</strong> Tokens: 390, Requests: 4 | <strong>With Caching Layer:</strong> Tokens: 89 (<span style="color: green">-77%</span>), Requests: 1 (<span style="color: green">-75%</span>)</p>
<p>Here, the LLM typically needs to be invoked 4 times, once per <code>[THING]</code> variable. On each call, this incurs a token and latency cost (both with OpenAI and local models). Separate calls are needed, because our template dictates the <code>-</code> token to be inserted before each <code>[THING]</code>.</p>
<p>With the caching layer, LMQL can now invoke the LLM only once, and fill in all variables with the resulting tokens, as long as the LLM output already aligns naturally with your template. In case the LLM result of the initial invocation at some point no longer aligns with the template, LMQL will automatically re-invoke the LLM from this point on, guaranteeing an overall consistent result that is already parsed into separate <code>[THING]</code> variables.</p>
<h3 id="short-circuiting-long-constraints" tabindex="-1">Short-Circuiting Long Constraints <a class="header-anchor" href="#short-circuiting-long-constraints" aria-label="Permalink to &quot;Short-Circuiting Long Constraints&quot;">&ZeroWidthSpace;</a></h3>
<p>When you specify long constraints like <code>A in [&quot;ABCDE&quot;, &quot;FGHIJK&quot;]</code>, the LMQL runtime guides the LLM to choose one of the provided options and then continues enforcing the sequence until the chosen values is fully decoded. To illustrate, consider the following query:</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="hljs"><code><span class="line"><span class="hljs-keyword">argmax</span>
    <span class="hljs-string">&quot;If we have the choice we choose<span class="hljs-placeholder">[OPTION]</span>&quot;</span>
<span class="hljs-keyword">from</span> 
    <span class="hljs-string">&quot;openai/text-ada-001&quot;</span>
<span class="hljs-keyword">where</span>
    OPTION <span class="hljs-keyword">in</span> [<span class="hljs-string">&quot;Option A with a whole lot of extra context&quot;</span>, 
        <span class="hljs-string">&quot;Option B with context&quot;</span>, 
        <span class="hljs-string">&quot;Another Option, also with a lot of additional text&quot;</span>
    ]
</span></code></pre>
</div><div class="language-promptdown vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">promptdown</span><pre pd-text="If we have the choice we choose [OPTION|Option A with a whole lot of extra context]
" animate="true" __animate="true" animate-speed="50" class="promptdown promptdown-compiled" style="opacity: 1;"><p pd-shadow-id="2438" text="I" pd-insertion-point="true">If we have the choice we choose <span pd-shadow-id="2440" pd-instant="false" text="" class="promptdown-var color-orange"><span pd-shadow-id="2441" text="O" class="promptdown-var-name">OPTION</span>Option A with a whole lot of extra context</span>
</p></pre>
</div><p><strong>Without Caching:</strong> Tokens: 123, Requests: 9 | <strong>With Caching Layer:</strong> Tokens: 25 (<span style="color: green">-80%</span>), Requests: 2 (<span style="color: green">-78%</span>)</p>
<p>Here, after the LLM has produced <code>&quot;Option&quot;</code> and then <code>&quot; A&quot;</code>, LMQL short-circuits further model calls and automatically completes the resulting sequence to <code>&quot;Option A with a whole lot of extra context&quot;</code>. This is possible because once <code>Option A</code> has been predicted, the remaining tokens are fully determined by the constraints.</p>
<h3 id="tool-augmented-queries" tabindex="-1">Tool-Augmented Queries <a class="header-anchor" href="#tool-augmented-queries" aria-label="Permalink to &quot;Tool-Augmented Queries&quot;">&ZeroWidthSpace;</a></h3>
<p>Lastly, we consider tool augmented queries. LLM agents and tool augmentation are very powerful paradigms, that allow LLMs to incorporate external knowledge and reasoning into their predictions. However, this comes at a cost: On each tool invocation, the LLM needs to be re-invoked to continue decoding after the tool output has been inserted. This impacts both the token cost and latency of running queries, as many requests have to be send forth and back between the LLM and the tool.</p>
<p>As an example, consider the following query that augments an LLM with the ability to use a key-value storage, <a href="http://lmql.ai/playground?snippet=kv" target="_blank" rel="noreferrer">also runnable in the browser-based LMQL Playground</a>.</p>
<center>
<a href="http://lmql.ai/playground?snippet=kv">
    <img src="https://user-images.githubusercontent.com/17903049/235436824-0150f73f-0ac6-4cd9-8cc9-d13343da54f0.png" alt="Key-Storage Augmented LLM implemented in LMQL" style="height:320pt;"/>
</a>
</center>
<p><strong>Without Caching:</strong> Tokens: 5,162, Requests: 12 | <strong>With Caching Layer:</strong> Tokens: 3,481 (<span style="color: green">-33%</span>), Requests: 8 (<span style="color: green">-33%</span>)</p>
<p>Here, whenever the LLM produces an action relating to our key-value storage, we invoke a tool that handles the storage and return the result (to <code>assign</code> and <code>get</code> stored values). The result of each tool invocation is then inserted into the LLM output, and the LLM is re-invoked to continue decoding.</p>
<p>We count 10 tool interactions which results in 12 requests if we run without caching. However, using the new caching layer, we can reduce this to 8 requests, even undercutting the number of tool interactions. This is possible because the caching layer will not abort LLM generation, if the LLM already correctly predicts the tool output.</p>
<p>This scenario demonstrates that the natural ability of LLMs to complete sequences can be leveraged to reduce the number of tool interactions, by relying on speculative execution.</p>
<h2 id="persisting-the-cache" tabindex="-1">Persisting the Cache <a class="header-anchor" href="#persisting-the-cache" aria-label="Permalink to &quot;Persisting the Cache&quot;">&ZeroWidthSpace;</a></h2>
<p>Of course, the in-memory cache of the LMQL runtime can also be persisted to disk, allowing you to reuse the cache tree across multiple queries, automatically reducing token cost and latency. In some cases this can even be used to reduce the number of requests to the LLM to 0, e.g. if the cache already contains the desired result.</p>
<p>To do so, you can simply specify a <code>cache=&quot;file.tokens&quot;</code> parameter in your query code:</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="hljs"><code><span class="line"><span class="hljs-keyword">argmax</span>(cache=<span class="hljs-string">&quot;joke.tokens&quot;</span>)
   <span class="hljs-string">&quot;&quot;&quot;A good dad joke. A indicates the punchline
   Q:<span class="hljs-placeholder">[JOKE]</span>
   A:<span class="hljs-placeholder">[PUNCHLINE]</span>&quot;&quot;&quot;</span>
<span class="hljs-keyword">from</span>
   <span class="hljs-string">&quot;openai/text-davinci-003&quot;</span>
<span class="hljs-keyword">where</span>
   <span class="hljs-built_in">len</span>(JOKE) &lt; <span class="hljs-number">120</span> <span class="hljs-keyword">and</span> 
   STOPS_AT(JOKE, <span class="hljs-string">&quot;?&quot;</span>) <span class="hljs-keyword">and</span> 
   STOPS_AT(PUNCHLINE, <span class="hljs-string">&quot;\n&quot;</span>) <span class="hljs-keyword">and</span> 
   <span class="hljs-built_in">len</span>(PUNCHLINE) &gt; <span class="hljs-number">1</span>
</span></code></pre>
</div><p>The first successful run of this query will persist the cache to <code>joke.tokens</code>. Subsequent runs will then automatically load the cache from disk, and only invoke the LLM if the cache does not contain a match. This also works for queries whose underlying LLM requests only partially overlap, as the tree-based cache data structure will automatically identify matching subtrees.</p>
<p><strong>Caching During Query Development</strong>: Persisting the cache can be particularly useful during query development, as it allows you to reuse the cache across multiple runs of the same query. A persistent cache will reduce token cost and latency of your query, even if you slightly change the query between runs.</p>
<h2 id="caveats-and-disabling-the-cache" tabindex="-1">Caveats and Disabling the Cache <a class="header-anchor" href="#caveats-and-disabling-the-cache" aria-label="Permalink to &quot;Caveats and Disabling the Cache&quot;">&ZeroWidthSpace;</a></h2>
<p>You can disable the caching layer by specifying <code>cache=False</code> in your query code. This will cause the LMQL runtime to always invoke the LLM, and never use the cache. This is useful for debugging purposes, or if you want to ensure that the LLM is always invoked.</p>
<p>Further, as the cache currently is implemented as an append-only data structure, it will grow indefinitely. This may be problematic for long-running applications, as the cache will eventually grow to relatively large sizes. In the future, we plan to implement simple strategies to limit the cache size, such as a least-recently-used eviction policy.</p>
<h2 id="conclusion" tabindex="-1">Conclusion <a class="header-anchor" href="#conclusion" aria-label="Permalink to &quot;Conclusion&quot;">&ZeroWidthSpace;</a></h2>
<p>In this post, we introduced the new caching layer of the LMQL runtime, which allows you to reduce the token cost and latency of your queries by reusing previously generated LLM outputs. We demonstrated how the caching layer can be used to reduce the number of LLM invocations in a variety of scenarios, including long constraints, short-circuiting, and tool-augmented queries. We also showed how the cache can be persisted to disk, allowing you to reuse the cache across multiple queries.</p>
<p>To learn more about LMQL please also check out our <a href="/docs.html">documentation</a>, or join our <a href="https://discord.gg/2Y3Wz2Q" target="_blank" rel="noreferrer">Discord</a> to chat with us directly. We are looking forward to hearing from you!</p>
</div></div></div><div class="posts" data-v-61c06c99><div class="post" data-v-61c06c99><a href="/blog/posts/release-0.0.5.html" data-v-61c06c99><h1 data-v-61c06c99>LMQL Release 0.0.5</h1></a><div class="body" data-v-61c06c99><h1 id="lmql-release-0-0-5" tabindex="-1">LMQL Release 0.0.5 <a class="header-anchor" href="#lmql-release-0-0-5" aria-label="Permalink to &quot;LMQL Release 0.0.5&quot;">&ZeroWidthSpace;</a></h1>
<p><span class="date">April 17, 2023</span></p>
<p>Today we are releasing version 0.0.5 of LMQL. This release focuses on stability and performance improvements. For a detailed list of changes, please see below. We are particularly excited about the first community contributions that have been merged as part of this release, with many more in the works.</p>
<p><code>lmql==0.0.5</code> has been published on <a href="https://pypi.org/project/lmql/" target="_blank" rel="noreferrer">PyPI</a>, based the current <code>main</code> branch of the <a href="https://github.com/eth-sri/lmql" target="_blank" rel="noreferrer">GitHub repository</a>. The updated version has also been deployed to the browser-based <a href="http://lmql.ai/playground" target="_blank" rel="noreferrer">lmql.ai/playground</a>.</p>
<h3 id="changelog" tabindex="-1">Changelog <a class="header-anchor" href="#changelog" aria-label="Permalink to &quot;Changelog&quot;">&ZeroWidthSpace;</a></h3>
<ul>
<li>
<p><strong>Decoder Performance</strong> The <code>argmax</code> and <code>sample</code> decoders have undergone some optimizations, allowing them to run faster. This results in a <em>20-30% speed-up</em> on common query workloads. <a href="https://github.com/eth-sri/lmql/pull/24" target="_blank" rel="noreferrer">#24</a>.</p>
</li>
<li>
<p><strong>Postprocessing Semantics</strong> Internally, LMQL now allows constraints to implement postprocessing semantics. This is used to convert variable values after they have been completed, to a more normalized form in the prompt, and to a semantically meaningful data type in the context of the query code. <a href="https://github.com/eth-sri/lmql/pull/24" target="_blank" rel="noreferrer">#24</a>.</p>
<p>For example, when using an <code>INT(&lt;var&gt;)</code> constraint on a generated number, the model will be restricted to only generate valid integers, and now, the resulting <code>NUM</code> value will additionally be converted to an <code>int</code> value:</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="hljs"><code><span class="line"><span class="hljs-keyword">argmax</span>
   <span class="hljs-string">&quot;My favorite number is: <span class="hljs-placeholder">[NUM]</span>\n&quot;</span>
   <span class="hljs-built_in">print</span>(<span class="hljs-built_in">type</span>(NUM), NUM * <span class="hljs-number">2</span>) <span class="hljs-comment"># &lt;class &#x27;int&#x27;&gt; 4</span>
   <span class="hljs-string">&quot;Number times two is <span class="hljs-subst">{NUM * <span class="hljs-number">2</span>}</span>&quot;</span>
<span class="hljs-keyword">from</span>
   <span class="hljs-string">&#x27;openai/text-ada-001&#x27;</span>
<span class="hljs-keyword">where</span>
   INT(NUM) 
</span></code></pre>
</div></li>
<li>
<p><strong>Core Interpreter</strong> A complete reimplementation of the LMQL core interpreter has been completed. This fixes a couple of minor issues and overall, improves reliability and performance when dealing with <em>branching</em> decoding algorithms. <a href="https://github.com/eth-sri/lmql/pull/24" target="_blank" rel="noreferrer">#24</a>.</p>
</li>
<li>
<p><strong>Playground</strong> Locally and when used in-browser, the <a href="http://lmql.ai/playground" target="_blank" rel="noreferrer">LMQL Playground</a> now <em>streams debugger information</em> from the LMQL interpreter incrementally. This leads to speed-ups when running in the Playground, especially with longer outputs. <a href="https://github.com/eth-sri/lmql/commit/27f9a8adb819f732608ef61c9aca9dca579dc536" target="_blank" rel="noreferrer">#27f9a8ad</a>.</p>
</li>
<li>
<p><strong>Other Fixes</strong>:</p>
<ul>
<li>When used from within Python (as decorated function), LMQL code no longer has to be doubly-escaped, e.g. you can now write <code>STOPS_AT(VAR, &quot;\n&quot;)</code> instead of <code>STOPS_AT(VAR, &quot;\\n&quot;)</code></li>
<li>The LMQL inference API buffers requests that come in during startup, to avoid errors when the server is not yet ready. <a href="https://github.com/eth-sri/lmql/pull/15" target="_blank" rel="noreferrer">#15</a>, thanks to <a href="https://github.com/chrispan" target="_blank" rel="noreferrer">@chrispan</a>.</li>
<li>OpenAI request parallelization no longer leads to an error on Linux systems, with regards to worker processes <a href="https://github.com/eth-sri/lmql/issues/6" target="_blank" rel="noreferrer">#6</a>.</li>
</ul>
</li>
</ul>
<h3 id="preview" tabindex="-1">Preview <a class="header-anchor" href="#preview" aria-label="Permalink to &quot;Preview&quot;">&ZeroWidthSpace;</a></h3>
<p>Apart from the changes above, we are also working on a number of other features, including:</p>
<ul>
<li>
<p><strong>llama.cpp support</strong> as started in <a href="https://github.com/eth-sri/lmql/pull/18" target="_blank" rel="noreferrer">this PR</a>, thanks to <a href="https://github.com/CircArgs" target="_blank" rel="noreferrer">@CircArgs</a>.</p>
</li>
<li>
<p>Support for <strong>Type Constraints</strong>, e.g.  <code>type(VAR) is DataClass</code>, that automatically force the model to produce a value that structurally conforms to the given type. See this <a href="https://twitter.com/lbeurerkellner/status/1646187597901733889" target="_blank" rel="noreferrer">Twitter thread</a> for more details.</p>
</li>
<li>
<p>Support for using <strong>Antlr parsers</strong> during query execution, to force the model to produce a value that conforms to a given grammar.</p>
</li>
<li>
<p><strong>Extending Logit Masking to OpenAI Chat Models</strong>. This will enable full support for LMQL constraints with e.g. <code>chatgpt</code> and <code>gpt-4</code> models. See <a href="https://github.com/eth-sri/lmql/pull/25" target="_blank" rel="noreferrer">#25</a>, thanks to <a href="https://github.com/kharvd" target="_blank" rel="noreferrer">@kharvd</a>.</p>
</li>
</ul>
</div></div></div><!--]--></div></div></main><footer class="VPDocFooter" data-v-a3c25e27 data-v-a2d931e4><!--[--><!--]--><!----><!----></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"readme.md\":\"82e2e066\",\"docs_installation.md\":\"8739ce92\",\"blog_posts_release-0.0.6.3.md\":\"a170b883\",\"blog_posts_release-0.0.6.4.md\":\"c7024d76\",\"blog_posts_release-0.0.6.5.md\":\"a82e82a9\",\"blog_posts_release-0.0.6.6.md\":\"958a76e8\",\"blog_posts_release-0.0.6.md\":\"2111a972\",\"blog_posts_release-0.7.md\":\"c15b0585\",\"docs_development_dev-setup.md\":\"94c94af5\",\"docs_development_docker-setup.md\":\"0e3e1b2c\",\"docs_index.md\":\"526a0692\",\"docs_language_overview.md\":\"4e5dda69\",\"docs_language_reference.md\":\"93969594\",\"docs_language_tools.md\":\"9aaa96de\",\"docs_language_scripted-prompting.md\":\"1a472d51\",\"docs_latest_development_dev-setup.md\":\"18f17674\",\"docs_latest_development_documentation.md\":\"c26b8856\",\"docs_latest_development_docker-setup.md\":\"fa59e371\",\"docs_latest_index.md\":\"45032e16\",\"docs_latest_installation.md\":\"4aae67b7\",\"docs_latest_language_constraints_custom-constraints.md\":\"a673b22d\",\"docs_latest_language_decorators.md\":\"53bd4b02\",\"docs_latest_language_constraints.md\":\"78575736\",\"docs_latest_language_decoding.md\":\"018937f6\",\"docs_latest_lib_chat.md\":\"00476b1d\",\"docs_latest_language_nestedqueries.md\":\"815f2dd9\",\"docs_latest_lib_chat_defend.md\":\"5cbe2338\",\"docs_latest_language_scripted-prompting.md\":\"12afea6e\",\"docs_latest_lib_inference-certificates.md\":\"414275b7\",\"docs_latest_lib_chat_serving.md\":\"c33c8e48\",\"docs_latest_lib_integrations.md\":\"eb75ecfa\",\"docs_latest_lib_integrations_llama_index.md\":\"4f2fe1b9\",\"docs_latest_lib_integrations_pandas.md\":\"9b6d3f34\",\"docs_latest_lib_python.md\":\"1c370ca3\",\"docs_latest_models_hf.md\":\"f6d5ed07\",\"docs_latest_language_reference.md\":\"26684918\",\"docs_latest_models_llama.cpp.md\":\"9e418aff\",\"docs_latest_models_openai.md\":\"0ecf2534\",\"docs_latest_models_replicate.md\":\"6800e6e2\",\"docs_lib_chat.md\":\"f8be0cb3\",\"docs_latest_lib_chat_overview.md\":\"aa834f5b\",\"docs_lib_chat_defend.md\":\"c253ac92\",\"docs_latest_lib_integrations_langchain.md\":\"42ff678a\",\"docs_latest_language_overview.md\":\"7387dad8\",\"docs_latest_lib_output.md\":\"4442e9f8\",\"docs_latest_models_azure.md\":\"d18f3972\",\"docs_lib_chat_internal.md\":\"865e3c38\",\"docs_lib_chat_overview.md\":\"6114091f\",\"docs_lib_generations.md\":\"4968526e\",\"docs_lib_integrations.md\":\"f23c2c07\",\"docs_latest_models_index.md\":\"d5054f5a\",\"docs_lib_chat_serving.md\":\"36ddd098\",\"docs_lib_integrations_llama_index.md\":\"f3803dc1\",\"docs_lib_integrations_pandas.md\":\"f1409ba3\",\"docs_lib_python.md\":\"bc95434a\",\"docs_models_hf.md\":\"00577347\",\"docs_models_index.md\":\"7dc07083\",\"features__1-types.md\":\"2e12a0c5\",\"docs_lib_output.md\":\"6e90a5e7\",\"features_examples_2-constraining.md\":\"cda9d411\",\"docs_models_azure.md\":\"167a3758\",\"docs_lib_integrations_langchain.md\":\"82a1a8ce\",\"features_examples_3.5-distributions.md\":\"9d7164a2\",\"features_examples_2.5-data-types.md\":\"7dcc82ab\",\"docs_latest_language_tools.md\":\"b9561422\",\"docs_latest_lib_generations.md\":\"e8df2635\",\"docs_models_llama.cpp.md\":\"89effe2c\",\"features_examples_3.6-python.md\":\"376501ff\",\"features_3-models.md\":\"eaf28c02\",\"docs_models_openai.md\":\"39ade1fd\",\"docs_development_documentation.md\":\"b9530bbc\",\"features_examples_6-chat.md\":\"cc86c446\",\"research_index.md\":\"c26a598e\",\"blog_posts_release-0.0.5.md\":\"6f3e470e\",\"docs_latest_lib_chat_internal.md\":\"fc68f234\",\"docs_language_constraints.md\":\"43fe4757\",\"docs_language_constraints_custom-constraints.md\":\"f81b18dd\",\"blog_posts_release-0.0.6.1.md\":\"120a8d77\",\"docs_language_decoding.md\":\"0469ec27\",\"docs_language_nestedqueries.md\":\"3fc05b78\",\"features_examples_5-wikipedia.md\":\"0f7e4309\",\"docs_models_replicate.md\":\"c1a2236a\",\"features_2-nested.md\":\"3c4c00f3\",\"docs_language_decorators.md\":\"9a3eb9c2\",\"docs_lib_inference-certificates.md\":\"9a213cfe\",\"features_1-code.md\":\"356f0c36\",\"features_examples_3-multi-part.md\":\"8bbbe3a5\",\"features_examples_1-packing-list.md\":\"6002788c\",\"index.md\":\"2eb98d23\",\"blog_index.md\":\"78d1ea8e\",\"features_examples_4-meta-prompting.md\":\"19152cd4\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"LMQL\",\"description\":\"Language Model Query Language\",\"base\":\"/\",\"head\":[],\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"Home\",\"link\":\"/\"},{\"text\":\"Blog\",\"link\":\"/blog/\",\"activeMatch\":\"^/blog/\"},{\"text\":\"Research\",\"link\":\"/research/index.html\"},{\"text\":\"Docs\",\"link\":\"/docs/\",\"activeMatch\":\"^/docs/\"},{\"text\":\"‚ñ∂ Playground\",\"link\":\"/playground/\",\"target\":\"_blank\"}],\"search\":{\"provider\":\"algolia\",\"options\":{\"appId\":\"TCP95GVDMD\",\"apiKey\":\"f7b4c9cd024536f8085f160045c3aafe\",\"indexName\":\"lmql\"}},\"logo\":\"/lmql.svg\",\"sidebar\":{\"docs/\":[{\"text\":\"\",\"collapsable\":true,\"collapsed\":false,\"base\":\"/docs/\",\"items\":[{\"text\":\"Getting Started\",\"link\":\"/index.md\"},{\"text\":\"Installation Instructions\",\"link\":\"/installation.md\"}]},{\"text\":\"Language\",\"collapsable\":true,\"collapsed\":false,\"base\":\"/docs/language\",\"items\":[{\"text\":\"Overview\",\"link\":\"/overview.md\"},{\"text\":\"Scripted Prompting\",\"link\":\"/scripted-prompting.md\"},{\"text\":\"Constraints\",\"link\":\"/constraints.md\",\"activeMatch\":\"^/docs/language/constraints/\",\"collapsable\":true,\"collapsed\":true,\"items\":[{\"text\":\"Custom Constraints\",\"link\":\"/constraints/custom-constraints.md\"}]},{\"text\":\"Decoders\",\"link\":\"/decoding.md\"},{\"text\":\"Decorators\",\"link\":\"/decorators.md\"},{\"text\":\"Nested Queries <span class=\\\"badge\\\">NEW</span>\",\"link\":\"/nestedqueries.md\"},{\"text\":\"Tool Augmentation\",\"link\":\"/tools.md\"},{\"text\":\"Language Reference\",\"link\":\"/reference.md\"}]},{\"text\":\"Model Support\",\"collapsable\":true,\"collapsed\":false,\"base\":\"/docs/models\",\"items\":[{\"text\":\"Overview\",\"link\":\"/index.md\"},{\"text\":\"Local Models / Transformers\",\"link\":\"/hf.md\"},{\"text\":\"llama.cpp\",\"link\":\"/llama.cpp.md\"},{\"text\":\"OpenAI\",\"link\":\"/openai.md\"},{\"text\":\"Azure\",\"link\":\"/azure.md\"},{\"text\":\"Replicate\",\"link\":\"/replicate.md\"}]},{\"text\":\"Library\",\"collapsable\":true,\"collapsed\":false,\"base\":\"/docs/lib\",\"items\":[{\"text\":\"Chat\",\"link\":\"/chat.md\",\"activeMatch\":\"^/docs/lib/chat/\",\"collapsable\":true,\"collapsed\":true,\"items\":[{\"text\":\"Your First Chatbot\",\"link\":\"/chat/overview.md\"},{\"text\":\"Serving\",\"link\":\"/chat/serving.md\"},{\"text\":\"Internal Reasoning\",\"link\":\"/chat/internal.md\"},{\"text\":\"Defending Against Prompt Injections\",\"link\":\"/chat/defend.md\"}]},{\"text\":\"Generations API <span class=\\\"badge\\\">NEW</span>\",\"link\":\"/generations.md\"},{\"text\":\"Inference Certificates\",\"link\":\"/inference-certificates.md\"},{\"text\":\"Output Streaming\",\"link\":\"/output.md\"},{\"text\":\"Python Integration\",\"link\":\"/python.md\"},{\"text\":\"Other Integrations\",\"link\":\"/integrations.md\",\"activeMatch\":\"^/docs/lib/integrations/\",\"collapsable\":true,\"collapsed\":true,\"items\":[{\"text\":\"LangChain\",\"link\":\"/integrations/langchain.md\"},{\"text\":\"LlamaIndex\",\"link\":\"/integrations/llama_index.md\"},{\"text\":\"Pandas\",\"link\":\"/integrations/pandas.md\"}]}]},{\"text\":\"Development\",\"collapsable\":true,\"collapsed\":false,\"base\":\"/docs/development\",\"items\":[{\"text\":\"Development Environment\",\"link\":\"/dev-setup.md\"},{\"text\":\"LMQL in Docker\",\"link\":\"/docker-setup.md\"},{\"text\":\"Documentation\",\"link\":\"/documentation.md\"}]}],\"docs/latest/\":[{\"text\":\"\",\"collapsable\":true,\"collapsed\":false,\"base\":\"/docs/latest/\",\"items\":[{\"text\":\"Getting Started\",\"link\":\"/index.md\"},{\"text\":\"Installation Instructions\",\"link\":\"/installation.md\"}]},{\"text\":\"Language\",\"collapsable\":true,\"collapsed\":false,\"base\":\"/docs/latest/language\",\"items\":[{\"text\":\"Overview\",\"link\":\"/overview.md\"},{\"text\":\"Scripted Prompting\",\"link\":\"/scripted-prompting.md\"},{\"text\":\"Constraints\",\"link\":\"/constraints.md\",\"activeMatch\":\"^/docs/latest/language/constraints/\",\"collapsable\":true,\"collapsed\":true,\"items\":[{\"text\":\"Custom Constraints\",\"link\":\"/constraints/custom-constraints.md\"}]},{\"text\":\"Decoders\",\"link\":\"/decoding.md\"},{\"text\":\"Decorators\",\"link\":\"/decorators.md\"},{\"text\":\"Nested Queries <span class=\\\"badge\\\">NEW</span>\",\"link\":\"/nestedqueries.md\"},{\"text\":\"Tool Augmentation\",\"link\":\"/tools.md\"},{\"text\":\"Language Reference\",\"link\":\"/reference.md\"}]},{\"text\":\"Model Support\",\"collapsable\":true,\"collapsed\":false,\"base\":\"/docs/latest/models\",\"items\":[{\"text\":\"Overview\",\"link\":\"/index.md\"},{\"text\":\"Local Models / Transformers\",\"link\":\"/hf.md\"},{\"text\":\"llama.cpp\",\"link\":\"/llama.cpp.md\"},{\"text\":\"OpenAI\",\"link\":\"/openai.md\"},{\"text\":\"Azure\",\"link\":\"/azure.md\"},{\"text\":\"Replicate\",\"link\":\"/replicate.md\"}]},{\"text\":\"Library\",\"collapsable\":true,\"collapsed\":false,\"base\":\"/docs/latest/lib\",\"items\":[{\"text\":\"Chat\",\"link\":\"/chat.md\",\"activeMatch\":\"^/docs/latest/lib/chat/\",\"collapsable\":true,\"collapsed\":true,\"items\":[{\"text\":\"Your First Chatbot\",\"link\":\"/chat/overview.md\"},{\"text\":\"Serving\",\"link\":\"/chat/serving.md\"},{\"text\":\"Internal Reasoning\",\"link\":\"/chat/internal.md\"},{\"text\":\"Defending Against Prompt Injections\",\"link\":\"/chat/defend.md\"}]},{\"text\":\"Generations API <span class=\\\"badge\\\">NEW</span>\",\"link\":\"/generations.md\"},{\"text\":\"Inference Certificates\",\"link\":\"/inference-certificates.md\"},{\"text\":\"Output Streaming\",\"link\":\"/output.md\"},{\"text\":\"Python Integration\",\"link\":\"/python.md\"},{\"text\":\"Other Integrations\",\"link\":\"/integrations.md\",\"activeMatch\":\"^/docs/latest/lib/integrations/\",\"collapsable\":true,\"collapsed\":true,\"items\":[{\"text\":\"LangChain\",\"link\":\"/integrations/langchain.md\"},{\"text\":\"LlamaIndex\",\"link\":\"/integrations/llama_index.md\"},{\"text\":\"Pandas\",\"link\":\"/integrations/pandas.md\"}]}]},{\"text\":\"Development\",\"collapsable\":true,\"collapsed\":false,\"base\":\"/docs/latest/development\",\"items\":[{\"text\":\"Development Environment\",\"link\":\"/dev-setup.md\"},{\"text\":\"LMQL in Docker\",\"link\":\"/docker-setup.md\"},{\"text\":\"Documentation\",\"link\":\"/documentation.md\"}]}]},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/eth-sri/lmql\"},{\"icon\":\"discord\",\"link\":\"https://discord.gg/5djae9gJVB\"}]},\"locales\":{},\"scrollOffset\":90,\"cleanUrls\":false}");</script>
    
  </body>
</html>